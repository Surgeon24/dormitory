<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>My Reservations</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>
<nav th:replace="~{fragments/navbar :: navbar(activePage='reservations')}"></nav>

<main class="container">
    <h1>My Reservations</h1>

    <div class="reservations-list">
        <div th:if="${reservations.isEmpty()}">
            <p>You have no reservations.</p>
        </div>
        <div th:each="reservation : ${reservations}" class="reservation-card"
             th:with="
                startTime=${T(java.time.LocalTime).of(reservation.reservationTimeStart / 60, reservation.reservationTimeStart % 60)},
                reservationDateTime=${T(java.time.LocalDateTime).of(reservation.reservationDate, startTime)},
                now=${T(java.time.LocalDateTime).now()}
             ">
            <p>
                Room ID: <span th:text="${reservation.reservationRoomId}"></span><br>
                Date: <span th:text="${reservation.reservationDate}"></span><br>
                Time: <span th:text="${startTime}"></span> -
                <span th:text="${T(java.time.LocalTime).of(reservation.reservationTimeStop / 60, reservation.reservationTimeStop % 60)}"></span>
            </p>

            <form th:if="${reservationDateTime.isAfter(now.plusMinutes(30))}"
                  th:action="@{/cancel-reservation}" method="post">
                <input type="hidden" name="reservationId" th:value="${reservation.reservationId}" />
                <button type="submit">Cancel Reservation</button>
            </form>
        </div>
    </div>
</main>

<footer th:replace="~{fragments/footer :: footer}"></footer>
</body>
</html>
